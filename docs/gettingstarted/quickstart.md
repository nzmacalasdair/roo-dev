# Quick Start


## Basic usage

Using GFFs in the same format as output by Prokka run:

```
mkdir results
panaroo -i *.gff -o results --clean-mode strict
```

If you are using GFFs from RefSeq they can occasionally include annotations that do not conform the expected. This is usually due to a premature stop codon or a gene of invalid length. By default Panaroo will fail to parse these annotations. However, you can set Panaroo to ignore invalid annotation by enabling the `remove-invalid-genes` flag 

```
panaroo -i *.gff -o results --clean-mode strict --remove-invalid-genes
```

## Mode

By default Panaroo runs in its strictest (most conservative) mode. We have found that for most use cases this removes potential sources of contamination and error whilst retaining the majority of genes researchers are interested in. 

Very rare plasmids are difficult to distinguish from contamination. Thus, if you are interested in retaining such plasmids at the expense of added contamination we recommend running panaroo using its most sensitive mode

```
panaroo -i *.gff -o results --clean-mode sensitive
```

## Different input formats

Panaroo now supports multiple input formats. To use non-standard GFF3 files you must profile the input file as a list in a text file (one per line). Separate GFF and FASTA files can be provided per isolate by providing each file delimited by a space or a tab. Genbank file formats are also supported with extensions '.gbk', '.gb' or '.gbff'. These must compliant with Genbank/ENA/DDJB. This can be forced in Prokka by specifying the `--compliance` parameter.

NOTE: Some annotations file such as those from RefSeq include annotations that break some of the assumptions of Panaroo. These include gene annotations of unusual length or that with premature stop codons (pseudogenes). By default Panaroo will throw an error if it encounters these annotations. You can automatically filter out such annotations by calling panaroo with the `--remove-invalid-genes` flag.

## Pre-processing scripts

It is usually a good idea to perform some rudimentary quality checks on the input data prior to running Panaroo. This can be accomplished using the pre-processing script provided.

The reference mash database can be downloaded from https://mash.readthedocs.io/en/latest/tutorials.html

```
panaroo-qc -t 3 --graph_type all -i *.gff --ref_db refseq.genomes.k21s1000.msh -o results
```

## Running Prokka

Panaroo is designed to correct for many sources of error introduced during annotation. This includes refinding genes in cases were there are inconsistencies in the annotation of the same genetic sequence in different genomes.

It is also possible to force Prokka to use the same gene model for each genome. This will improve the consistency of annotations but any biases present in the model will be present in all genome annotations.

To run Prokka in this way you can build an initial model by running Prodigal on a genome assembly you believe is a reliable representative of you data set.

```
prodigal -t prodigal_training_file -c -m -g 11 -p single -q -i input_file.fasta > /dev/null
```

Annotations can then be generated by running Prokka with the `--prodigaltf` parameter

```
prokka --prodigaltf prodigal_training_file input_file.fasta
```

